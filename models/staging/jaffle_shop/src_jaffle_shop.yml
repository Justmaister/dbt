version: 2

sources:
    - name: jaffle_shop
      description: A clone of a Postgres application database.
      database: dbt-tutorial
      schema: jaffle_shop
      tables:
        - name: customers
          description: Raw customers data.
          config:
            elementary:
              timestamp_column: _timestamp_at
          tests:
            - elementary.table_anomalies:
                table_anomalies:
                  - freshness
                  - row_count
                  - schema_changes
                tags: ['elementary']
                sensitivity: 3
                config:
                  days_back: 90
                  severity: error
                timestamp_column: _timestamp_at
          columns:
            - name: id
              description: Primary key for customers.
              tests:
                - unique
                - not_null

        - name: orders
          description: Raw orders data.
          config:
            elementary:
              timestamp_column: _timestamp_at
          tests:
            - elementary.table_anomalies:
                table_anomalies:
                  - freshness
                  - row_count
                  - schema_changes
                tags: ['elementary']
                sensitivity: 3
                config:
                  days_back: 90
                  severity: error
                timestamp_column: _timestamp_at
          columns:
            - name: id
              description: Primary key for orders.
              tests:
                - unique
                - not_null
          loaded_at_field: _etl_loaded_at
          freshness:
              warn_after: {count: 12, period: hour}
              error_after: {count: 24, period: hour}